pipeline {
    agent any
     triggers{
        pollSCM('H * * * *')
    }
    
    tools{
            maven 'maven-3'
            jdk 'java11'
    }
    
    stages {
        stage('Maven-Clean'){
            steps{
                sh 'mvn clean'
            }
        }
        stage('Maven-Compile'){
            steps{
                sh 'mvn compile'
            }
        }
        stage('Maven-test'){
            steps{
                sh 'mvn test'
            }
        }
        stage('Maven-Package'){
            steps{
                sh 'mvn package'
            }
        }
         stage('build && SonarQube analysis') {
            steps {
                withSonarQubeEnv('sonarqube') {
                    
                        bat 'mvn package sonar:sonar'
			 //sh 'mvn verify org.sonarsource.scanner.maven:sonar-maven-plugin:sonar'
                    
                }
            }
        }
    }
    
     post {
                always {
                    junit '**/target/surefire-reports/TEST-*.xml'
                    archiveArtifacts 'target/*.jar'
                       }
         
            }
}

